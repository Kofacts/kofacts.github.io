---
import BaseHead from '../components/BaseHead.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import { fetchRSSPosts } from '../utils/rss.js';
import { fetchGoodreadsCurrentlyReading } from '../utils/goodreads.js';

const allPosts = await fetchRSSPosts();
const essays = allPosts.slice(0, 5);
const currentlyReading = await fetchGoodreadsCurrentlyReading();

const formatDate = (dateStr) => {
  const date = new Date(dateStr);
  return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short' });
};

const personSchema = {
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Rapheal Obodugo",
  "url": "https://obodugo.online",
  "jobTitle": "Founder",
  "worksFor": { "@type": "Organization", "name": "Avae", "url": "https://avae.ai" }
};
---

<!doctype html>
<html lang="en">
<head>
	<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} structuredData={personSchema} ogType="profile" />
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>

<div class="scroll-progress" id="scrollProgress"></div>

<div class="sticky-header" id="stickyHeader">
	<div class="sticky-inner">
		<img src="/ajabruwal.png" alt="" class="sticky-avatar">
		<span class="sticky-name">Rapheal Obodugo</span>
		<span class="sticky-spacer"></span>
		<span class="sticky-time" id="londonTime"></span>
	</div>
</div>

<main>
	<header class="animate-section" style="--delay: 0">
		<img src="/ajabruwal.png" alt="" class="avatar">
		<h1>Rapheal Obodugo</h1>
		<p class="role">Founder of <a href="https://avae.ai" target="_blank" rel="noopener noreferrer">Avae</a></p>
	</header>

	<section class="about animate-section" style="--delay: 1">
		<p>I'm building <a href="https://avae.ai" target="_blank" rel="noopener noreferrer">Avae</a>, an AI that handles tasks for you — booking travel, researching markets, managing your inbox, following up on things. We're in private beta with strong early traction.</p>
		<p>Before this: built and exited <a href="https://mysub.africa" target="_blank" rel="noopener noreferrer">MySub</a> (360k users), led engineering at <a href="https://derayah.com" target="_blank" rel="noopener noreferrer">Derayah Finance</a>, worked on infra at <a href="https://meta.com" target="_blank" rel="noopener noreferrer">Meta</a>.</p>
		<p>I spend a lot of time reading. Mostly history, philosophy, and biographies — I like understanding how people thought and why systems work the way they do. Sometimes fiction when I need to escape.</p>
		<p>I write about building products, execution, and lessons from operating in emerging markets.</p>
		<p>I occasionally advise early-stage startups on product and engineering. <a href="mailto:raph@avae.ai">Get in touch</a> if you're building something interesting.</p>
	</section>

	<section class="writing animate-section" style="--delay: 2">
		<h2>Essays</h2>
		{essays.length > 0 && (
			<a href={`/blog/${essays[0].slug}/`} class="featured">
				<span class="featured-label">Latest</span>
				<span class="featured-title">{essays[0].title}</span>
			</a>
		)}
		{essays.slice(1).map((post) => (
			<a href={`/blog/${post.slug}/`} class="post">
				<span>{post.title}</span>
				<time>{formatDate(post.date)}</time>
			</a>
		))}
		<a href="/blog" class="more">All essays →</a>
	</section>

	{currentlyReading.length > 0 && (
		<section class="reading animate-section" style="--delay: 3">
			<h2>Currently Reading</h2>
			<div class="books-grid">
				{currentlyReading.map((book) => (
					<a href={book.link} class="book" target="_blank" rel="noopener noreferrer">
						{book.imageUrl && (
							<div class="book-cover-wrapper">
								<img src={book.imageUrl} alt={book.title} class="book-cover" loading="lazy" />
							</div>
						)}
						<div class="book-info">
							<span class="book-title">{book.title}</span>
							<span class="book-author">{book.author}</span>
						</div>
					</a>
				))}
			</div>
			<a href="/bookshelf" class="more">All books →</a>
		</section>
	)}

	<section class="links animate-section" style="--delay: 4">
		<a href="mailto:raph@avae.ai">Email</a>
		<a href="https://twitter.com/thekofacts" target="_blank" rel="noopener noreferrer">Twitter</a>
		<a href="https://linkedin.com/in/obodugo" target="_blank" rel="noopener noreferrer">LinkedIn</a>
		<a href="https://calendar.app.google/JWpSBB15VvwmQUdA8" target="_blank" rel="noopener noreferrer">Book a call</a>
		<a href="/stack">Stack</a>
		<a href="/now">Now</a>
	</section>

	<footer class="animate-section" style="--delay: 5">
		<span>Lagos · Riyadh · London</span>
		<a href="https://avae.ai" target="_blank" rel="noopener noreferrer" class="avae-credit">Built with Avae</a>
	</footer>
</main>

<div class="grain"></div>

<style is:global>
	* { margin: 0; padding: 0; box-sizing: border-box; }
	
	body {
		font-family: 'Inter', system-ui, sans-serif;
		background: #09090b;
		color: #a1a1aa;
		line-height: 1.65;
		-webkit-font-smoothing: antialiased;
	}
	
	/* Scroll Progress */
	.scroll-progress {
		position: fixed;
		top: 0;
		left: 0;
		height: 2px;
		background: linear-gradient(90deg, #3f3f46, #52525b);
		width: 0%;
		z-index: 10000;
		transition: width 0.1s ease-out;
	}
	
	main {
		max-width: 520px;
		margin: 0 auto;
		padding: 80px 24px 100px;
	}
	
	/* Header */
	header {
		margin-bottom: 48px;
	}
	
	.avatar {
		width: 64px;
		height: 64px;
		border-radius: 50%;
		margin-bottom: 20px;
		opacity: 0.95;
		animation: breathe 4s ease-in-out infinite;
	}
	
	@keyframes breathe {
		0%, 100% { box-shadow: 0 0 0 0 rgba(250, 250, 250, 0); }
		50% { box-shadow: 0 0 20px 2px rgba(250, 250, 250, 0.06); }
	}
	
	.avatar:hover {
		box-shadow: 0 0 0 3px rgba(250, 250, 250, 0.1);
		animation: none;
	}
	
	h1 {
		font-size: 20px;
		font-weight: 600;
		color: #fafafa;
		letter-spacing: -0.02em;
		margin-bottom: 4px;
	}
	
	.role {
		font-size: 15px;
		color: #71717a;
	}
	
	.role a {
		color: #fafafa;
		text-decoration: none;
		border-bottom: 1px solid #3f3f46;
		transition: border-color 0.2s;
	}
	
	.role a:hover {
		border-color: #71717a;
	}
	
	.role a::after {
		content: ' ↗';
		font-size: 0.7em;
		opacity: 0.5;
	}
	
	/* About */
	.about {
		margin-bottom: 56px;
	}
	
	.about p {
		font-size: 15px;
		margin-bottom: 16px;
	}
	
	.about p:last-child {
		margin-bottom: 0;
	}
	
	.about strong {
		color: #d4d4d8;
		font-weight: 500;
	}
	
	.about a {
		color: #d4d4d8;
		text-decoration: none;
		position: relative;
		transition: color 0.2s;
	}
	
	.about a::before {
		content: '';
		position: absolute;
		bottom: -2px;
		left: 0;
		width: 100%;
		height: 1px;
		background: #52525b;
		transform: scaleX(0);
		transform-origin: left;
		transition: transform 0.3s ease;
	}
	
	.about a:hover::before {
		transform: scaleX(1);
	}
	
	.about a:hover {
		color: #fafafa;
	}
	
	.about a[href^="mailto"]::after,
	.about a[href^="http"]::after {
		content: ' ↗';
		font-size: 0.75em;
		opacity: 0.5;
	}
	
	.about em {
		color: #d4d4d8;
		font-style: italic;
	}
	
	/* Writing */
	.writing {
		margin-bottom: 56px;
	}
	
	h2 {
		font-size: 11px;
		font-weight: 500;
		text-transform: uppercase;
		letter-spacing: 0.1em;
		color: #52525b;
		margin-bottom: 20px;
	}
	
	.featured {
		display: block;
		text-decoration: none;
		padding: 16px;
		margin: 0 -16px 16px;
		background: #111113;
		border-radius: 8px;
		border: 1px solid #27272a;
		transition: border-color 0.2s;
	}
	
	.featured:hover {
		border-color: #3f3f46;
	}
	
	.featured-label {
		display: block;
		font-size: 10px;
		font-weight: 500;
		text-transform: uppercase;
		letter-spacing: 0.1em;
		color: #52525b;
		margin-bottom: 6px;
	}
	
	.featured-title {
		font-size: 16px;
		color: #fafafa;
		font-weight: 500;
	}
	
	.post {
		display: flex;
		justify-content: space-between;
		align-items: baseline;
		gap: 16px;
		padding: 12px 0;
		text-decoration: none;
		border-bottom: 1px solid #18181b;
	}
	
	.post:last-of-type {
		border-bottom: none;
	}
	
	.post span {
		font-size: 14px;
		color: #d4d4d8;
		transition: color 0.2s;
	}
	
	.post:hover span {
		color: #fafafa;
	}
	
	.post time {
		font-size: 13px;
		color: #3f3f46;
		flex-shrink: 0;
	}
	
	.more {
		display: inline-block;
		margin-top: 16px;
		font-size: 13px;
		color: #52525b;
		text-decoration: none;
		transition: color 0.2s;
	}
	
	.more:hover {
		color: #71717a;
	}
	
	/* Reading */
	.reading {
		margin-bottom: 56px;
	}
	
	.book {
		display: block;
		text-decoration: none;
		padding: 10px 0;
		border-bottom: 1px solid #18181b;
	}
	
	.book:last-of-type {
		border-bottom: none;
	}
	
	.book-title {
		display: block;
		font-size: 14px;
		color: #d4d4d8;
		transition: color 0.2s;
	}
	
	.book-title::after {
		content: ' ↗';
		font-size: 0.7em;
		opacity: 0.4;
	}
	
	.book:hover .book-title {
		color: #fafafa;
	}
	
	.book-author {
		font-size: 13px;
		color: #52525b;
	}
	
	/* Links */
	.links {
		display: flex;
		gap: 20px;
		flex-wrap: nowrap;
		overflow-x: auto;
		-webkit-overflow-scrolling: touch;
		margin-bottom: 64px;
		padding-bottom: 4px;
	}
	
	.links a {
		font-size: 13px;
		color: #52525b;
		text-decoration: none;
		transition: color 0.2s;
	}
	
	.links a:hover {
		color: #a1a1aa;
	}
	
	.links a[href^="http"]::after,
	.links a[href^="mailto"]::after {
		content: ' ↗';
		font-size: 0.7em;
		opacity: 0.4;
	}
	
	/* Footer */
	footer {
		display: flex;
		justify-content: space-between;
		align-items: center;
		font-size: 12px;
		color: #27272a;
	}
	
	.avae-credit {
		color: #27272a;
		text-decoration: none;
		transition: color 0.2s;
	}
	
	.avae-credit:hover {
		color: #52525b;
	}
	
	/* Sticky Header */
	.sticky-header {
		position: fixed;
		top: 16px;
		left: 50%;
		transform: translateX(-50%) translateY(-60px);
		max-width: 520px;
		width: calc(100% - 48px);
		background: rgba(9, 9, 11, 0.85);
		backdrop-filter: blur(12px);
		-webkit-backdrop-filter: blur(12px);
		border: 1px solid rgba(39, 39, 42, 0.5);
		border-radius: 12px;
		opacity: 0;
		transition: 
			transform 0.5s cubic-bezier(0.16, 1, 0.3, 1),
			opacity 0.4s ease-out;
		z-index: 1000;
	}
	
	.sticky-header.visible {
		transform: translateX(-50%) translateY(0);
		opacity: 1;
	}
	
	.sticky-inner {
		padding: 12px 20px;
		display: flex;
		align-items: center;
		gap: 12px;
	}
	
	.sticky-avatar {
		width: 28px;
		height: 28px;
		border-radius: 50%;
		opacity: 0.95;
		transition: transform 0.3s ease;
	}
	
	.sticky-header:hover .sticky-avatar {
		transform: scale(1.05);
	}
	
	.sticky-name {
		font-size: 14px;
		font-weight: 500;
		color: #fafafa;
	}
	
	.sticky-spacer {
		flex: 1;
	}
	
	.sticky-time {
		font-size: 12px;
		color: #52525b;
		font-variant-numeric: tabular-nums;
	}
	
	/* Staggered Fade-in Animation */
	@keyframes fadeInUp {
		from {
			opacity: 0;
			transform: translateY(16px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}
	
	.animate-section {
		opacity: 0;
		animation: fadeInUp 0.6s ease-out forwards;
		animation-delay: calc(var(--delay, 0) * 0.1s);
	}
	
	/* Avatar scale on load */
	@keyframes avatarPop {
		0% { transform: scale(0.9); opacity: 0.5; }
		100% { transform: scale(1); opacity: 1; }
	}
	
	.avatar {
		animation: avatarPop 0.5s ease-out forwards;
	}
	
	/* Post row hover lift */
	.post {
		transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
		border-left: 2px solid transparent;
		padding-left: 12px;
		margin-left: -14px;
	}
	
	.post:hover {
		transform: translateX(4px);
		border-left-color: #3f3f46;
	}
	
	.featured {
		transition: transform 0.2s ease, box-shadow 0.2s ease;
	}
	
	.featured:hover {
		transform: translateY(-2px);
		box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
	}
	
	.books-grid {
		display: flex;
		flex-wrap: wrap;
		gap: 24px;
		margin-top: 16px;
	}
	
	.book {
		display: flex;
		flex-direction: column;
		gap: 10px;
		text-decoration: none;
		max-width: 160px;
		perspective: 800px;
	}
	
	.book-cover-wrapper {
		display: contents;
	}
	
	.book-cover {
		width: 100%;
		height: auto;
		max-height: 240px;
		object-fit: contain;
		border-radius: 4px;
		box-shadow: 
			0 8px 24px rgba(0, 0, 0, 0.4),
			inset 4px 0 8px -4px rgba(0, 0, 0, 0.3);
		transition: transform 0.4s ease, box-shadow 0.4s ease;
		transform-style: preserve-3d;
	}
	
	.book:hover .book-cover {
		transform: rotateY(-12deg) rotateX(4deg) scale(1.03);
		box-shadow: 
			12px 16px 32px rgba(0, 0, 0, 0.5),
			inset 6px 0 12px -4px rgba(0, 0, 0, 0.4);
	}
	
	.book-info {
		display: flex;
		flex-direction: column;
		gap: 2px;
		min-width: 0;
	}
	
	.book-title {
		font-size: 14px;
		color: #d4d4d8;
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
		display: block;
	}
	
	.book-author {
		font-size: 12px;
		color: #52525b;
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
	}
	
	/* Grain overlay */
	.grain {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		pointer-events: none;
		opacity: 0.015;
		z-index: 9999;
		background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
	}
	
	/* Mobile */
	@media (max-width: 520px) {
		main { padding: 48px 20px 64px; }
		.post { flex-direction: column; gap: 4px; }
		.sticky-header { 
			top: 12px;
			width: calc(100% - 32px);
		}
		.sticky-inner {
			padding: 10px 16px;
			gap: 8px;
		}
		.sticky-avatar {
			width: 24px;
			height: 24px;
		}
		.sticky-name {
			font-size: 13px;
		}
		.sticky-time {
			font-size: 11px;
		}
		.links {
			gap: 12px;
		}
		.links a {
			font-size: 11px;
		}
	}
</style>

<script>
	const header = document.querySelector('header');
	const stickyHeader = document.getElementById('stickyHeader');
	
	const observer = new IntersectionObserver(
		([entry]) => {
			if (!entry.isIntersecting) {
				stickyHeader.classList.add('visible');
			} else {
				stickyHeader.classList.remove('visible');
			}
		},
		{ threshold: 0, rootMargin: '-80px 0px 0px 0px' }
	);
	
	if (header) observer.observe(header);
	
	// London time clock
	const timeEl = document.getElementById('londonTime');
	const updateTime = () => {
		const now = new Date();
		const london = now.toLocaleTimeString('en-GB', {
			timeZone: 'Europe/London',
			hour: '2-digit',
			minute: '2-digit',
			hour12: false
		});
		timeEl.textContent = `${london} London`;
	};
	updateTime();
	setInterval(updateTime, 60000);
	
	// Scroll effects: progress bar + parallax avatar
	const avatar = document.querySelector('.avatar');
	const progressBar = document.getElementById('scrollProgress');
	
	window.addEventListener('scroll', () => {
		const scrollY = window.scrollY;
		const docHeight = document.documentElement.scrollHeight - window.innerHeight;
		
		// Progress bar
		if (progressBar && docHeight > 0) {
			const progress = (scrollY / docHeight) * 100;
			progressBar.style.width = `${progress}%`;
		}
		
		// Parallax avatar
		if (avatar) {
			avatar.style.transform = `translateY(${scrollY * 0.15}px)`;
		}
	}, { passive: true });
</script>

</body>
</html>